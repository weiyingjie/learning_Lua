[TOC]

### 字符串操作

-   string.upper(arg)：字符串全部转为大写

-   string.lower(arg)：字符串全部转为小写

-   string.gsub(string, pattern, repl, [, n])：字符串替换
    -   string是源字符串
    -   pattern是规则，类似正则
    -   repl如果是字符串则替换；如果是表，则将匹配结果作为键去查表；如果是函数，则每次匹配到就会调用一次这个函数，所有捕获到的子串依次作为参数传入，当为表或函数时，表的查询结果或函数的返回值为字符串或数字，则替换，是false或nil则不做替换
    -   n是替换次数，忽略则全部替换
    
-   string.find(string, pattern[, init [, plain]])：查找子串，返回起止下标，不存在返回nil
    -   string是源字符串
    -   pattern是匹配规则
    -   init是从哪里开始
    -   plain为true是表示关闭匹配规则，将pattern单看作字符串，启用这个参数时必须设置init
    
-   string.reverse(arg)：字符串反转

-   string.format()：格式化字符串

-   string.char(arg)和string.byte(arg[, int])

    -   char将整型数字转成字符
    -   byte将字符转成数字，默认第一个字符，int指定第几个字符

-   string.len(arg)：字符串长度

-   string.rep(string, n)

    -   string.rep("abcd", 2)

        \> abcdabcd

-   string.gmatch(string, pattern)：返回一个迭代器函数，每一次调用这个函数，返回一个在字符串 str 找到的下一个符合 pattern 描述的子串。如果参数 pattern 描述的字符串没有找到，迭代函数返回nil。

    ```lua
    > for word in string.gmatch("Hello Lua user", "%a+") do print(word) end
    Hello
    Lua
    user
    ```

-   string.match(str, pattern, init)：string.match()只寻找源字串str中的第一个配对. 参数init可选, 指定搜寻过程的起点, 默认为1。

### 字符串截取

string.sub(str, start [, stop])

str：要截取的字符串

start：开始位置

stop：结束位置（默认是-1，最后一个字符）

### 匹配模式

-   单个字符(除 **^$()%.[]\*+-?** 外): 与该字符自身配对

-   .(点): 与任何字符配对

-   %a: 与任何字母配对

-   %c: 与任何控制符配对(例如\n)

-   %d: 与任何数字配对

-   %l: 与任何小写字母配对

-   %p: 与任何标点(punctuation)配对

-   %s: 与空白字符配对

-   %u: 与任何大写字母配对

-   %w: 与任何字母/数字配对

-   %x: 与任何十六进制数配对

-   %z: 与任何代表0的字符配对

-   %x(此处x是非字母非数字字符): 与字符x配对. 主要用来处理表达式中有功能的字符(^$()%.[]*+-?)的配对问题, 例如%%与%配对

-   [数个字符类]: 与任何[]中包含的字符类配对. 例如[%w_]与任何字母/数字, 或下划线符号(_)配对

-   \[^数个字符类]: 与任何不包含在[]中的字符类配对. 例如 ^%s与任何非空白字符配对

当上述的字符类用大写书写时, 表示与非此字符类的任何字符配对. 例如, %S表示与任何非空白字符配对.例如，'%A'非字母的字符

'%' 用作特殊字符的转义字符，因此 '%.' 匹配点；'%%' 匹配字符 '%'。转义字符 '%'不仅可以用来转义特殊字符，还可以用于所有的非字母的字符

**模式条目可以是：**

-   单个字符类匹配该类别中任意单个字符；
-   单个字符类跟一个 '`*`'， 将匹配零或多个该类的字符。 这个条目总是匹配尽可能长的串；
-   单个字符类跟一个 '`+`'， 将匹配一或更多个该类的字符。 这个条目总是匹配尽可能长的串；
-   单个字符类跟一个 '`-`'， 将匹配零或更多个该类的字符。 和 '`*`' 不同， 这个条目总是匹配尽可能短的串；
-   单个字符类跟一个 '`?`'， 将匹配零或一个该类的字符。 只要有可能，它会匹配一个；
-   `%n`， 这里的 *n* 可以从 1 到 9； 这个条目匹配一个等于 *n* 号捕获物（后面有描述）的子串。
-   %b*xy*， 这里的 *x* 和 *y* 是两个明确的字符； 这个条目匹配以 *x* 开始 *y* 结束， 且其中 *x* 和 *y* 保持 *平衡* 的字符串。 意思是，如果从左到右读这个字符串，对每次读到一个 *x* 就 *+1* ，读到一个 *y* 就 *-1*， 最终结束处的那个 *y* 是第一个记数到 0 的 *y*。 举个例子，条目 `%b()` 可以匹配到括号平衡的表达式。
-   `%f[set]`， 指 *边境模式*； 这个条目会匹配到一个位于 *set* 内某个字符之前的一个空串， 且这个位置的前一个字符不属于 *set* 。 集合 *set* 的含义如前面所述。 匹配出的那个空串之开始和结束点的计算就看成该处有个字符 '`\0`' 一样。